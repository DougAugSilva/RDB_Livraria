Atualizações 27/09/2025

-- Crirei tabela RECEBIMENTO no banco de dados STAGE.
-- Realizei um BULK INSERT na tabela RECEBIMENTO, com base nos dados do csv "recebimento".
============================================================================
Querys utilizadas 

USE STAGE;

CREATE TABLE RECEBIMENTO (
    NUMERO_NOTA_FISCAL INT,
    DATA_PARCELA DATE,
    DATA_RECEBIMENTO DATE,
    VALOR_PARCELA DECIMAL(10, 2),
    VALOR_PAGO DECIMAL(10, 2)
);

SELECT * FROM RECEBIMENTO;

select * from LIVRARIADB.dbo.PROG_RECEBIMENTO;

BULK INSERT RECEBIMENTO
FROM 'C:\Arquivos_banco_dados\recebimentos.csv'
	WITH (
			FIELDTERMINATOR = ',',
			ROWTERMINATOR = '\n',
			FIRSTROW = 2,
			CODEPAGE = 65001
			);

ALTER TABLE RECEBIMENTO
ADD NUMERO_PARCELA INT;

EXEC sp_rename 'LIVRARIADB.dbo.TIPO_DESCONTO.`LIVRARIADB.dbo.TIPO_DESCONTO.STATUS`', 'STATUS', 'COLUMN'; --consertar

=======================================================================
Tarefas

[1]. Realisar insert na tabela HISTORICO_RECEBIMENTO todas as parcelas recebidas (independenete
de estarem válidas ou não).

[2]. Inserir as parcelas divergentes na tabela HISTORICO_DIVERGENTE.

[3]. Realisar um upadate na tabela PROG_RECEBIMENTO das parecelas recebidas (independente de o valor pago estar 
diferente do valor que deveria ser pago).

-----------------------------------------------------------
A tabela LIVRARIADB.dbo.TIPO_DESCONTO deve ser alterada do seguinte modelo

1. Deve ser criado linhas para comporatr um tipo com o minimo de 0 dias e um com o minimo de 1 dia.
2. Realiar uma alteração na coluna TIPO, de modo que deve conter apenas valores 0 ou 1, com 0 = Juros e 1 = Desconto.
3. Alterar a coluna ESTATUS para se chamar STATUS.
4. A tabela deve ter seus dados deletados, para conter as seguintes infromações:
-- Pagou antecipado (entre 1 e 5 dias), dar de 1% a 2% de desconto,
-- Pagou antecipado (entre 6 a 10 dias), dar de 2% a 5% de desconto,
-- Pagou antecipado (maior que 10 dias), dar 8% de desconto,
-- Pagou com 0 dias dar 0% de desconto,
-- Pagou atrazado (entre 1 e 5 dias), dar de 1% a 2% de juros,
-- Pagou atrazado (entre 6 a 10 dias), dar de 2% a 5% de juros,
-- Pagou atrazado (maior que 10 dias), dar 8% de juros